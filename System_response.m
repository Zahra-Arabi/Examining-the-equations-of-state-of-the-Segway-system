% پارامترهای سیستم خطی شده
A = [0 1 0 0; 0 0 -0.98 0; 0 0 0 1; 0 0 19.6 0];  % ماتریس A
B = [0; 1; 0; -1];  % ماتریس B

% شرایط اولیه
x0_1 = [0; 0; 0.1; 0];  % شرایط اولیه اول
x0_2 = [0; 0; -0.1; 0];  % شرایط اولیه دوم

% ورودی‌ها
u1 = 0;  % ورودی اول (بدون ورودی)
u2 = 1;  % ورودی دوم (ورودی ثابت)

% بازه زمانی شبیه‌سازی
t = [0 10];  % از 0 تا 10 ثانیه

% شبیه‌سازی سیستم خطی شده
[T, X1] = ode45(@(t, x) A*x + B*u1, t, x0_1);
[T, X2] = ode45(@(t, x) A*x + B*u2, t, x0_1);
[T, X3] = ode45(@(t, x) A*x + B*u1, t, x0_2);
[T, X4] = ode45(@(t, x) A*x + B*u2, t, x0_2);

% نمایش نتایج
figure;
subplot(2,1,1);
plot(T, X1(:, 1), T, X2(:, 1), T, X3(:, 1), T, X4(:, 1));
title('پاسخ حلقه باز سیستم خطی شده (موقعیت)');
xlabel('زمان (ثانیه)');
ylabel('x (متر)');
legend('x0 = [0; 0; 0.1; 0], u = 0', 'x0 = [0; 0; 0.1; 0], u = 1', 'x0 = [0; 0; -0.1; 0], u = 0', 'x0 = [0; 0; -0.1; 0], u = 1');

subplot(2,1,2);
plot(T, X1(:, 3), T, X2(:, 3), T, X3(:, 3), T, X4(:, 3));
title('پاسخ حلقه باز سیستم خطی شده (زاویه)');
xlabel('زمان (ثانیه)');
ylabel('\theta (رادیان)');
legend('x0 = [0; 0; 0.1; 0], u = 0', 'x0 = [0; 0; 0.1; 0], u = 1', 'x0 = [0; 0; -0.1; 0], u = 0', 'x0 = [0; 0; -0.1; 0], u = 1');

